<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.chess.mapper.PostMapper">

    <insert id="insertPost" parameterType="com.example.chess.dto.PostDto">
        INSERT INTO POSTS (PK_POST, FK_USER, TITLE, CONTENT, CREATED_AT, UPDATED_AT)
        VALUES (POSTS_SEQ.NEXTVAL, #{fkUser}, #{title}, #{content}, SYSTIMESTAMP, SYSTIMESTAMP)
    </insert>

    <select id="selectPost" resultType="com.example.chess.dto.PostDto">
        SELECT * FROM POSTS WHERE PK_POST = #{pkPost}
    </select>

    <select id="selectPostsByUser" resultType="com.example.chess.dto.PostDto" parameterType="Long">
        SELECT * FROM POSTS WHERE FK_USER = #{fkUser} ORDER BY CREATED_AT DESC
    </select>

    <select id="selectAllPosts" resultType="com.example.chess.dto.PostDto">
        SELECT * FROM POSTS ORDER BY CREATED_AT DESC                                                 
    </select>

    <update id="updatePost" parameterType="com.example.chess.dto.PostDto">
        UPDATE POSTS
        SET TITLE = #{title}, CONTENT = #{content}, UPDATED_AT = SYSTIMESTAMP
        WHERE PK_POST = #{pkPost}
    </update>

    <delete id="deletePost">
        DELETE FROM POSTS WHERE PK_POST = #{pkPost}
    </delete>

</mapper>